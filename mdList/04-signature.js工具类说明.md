# signature.js 工具类说明

## 概述
`signature.js` 是一个签名工具类，主要用于生成数据签名，确保数据传输的完整性和安全性。该工具类结合了加密工具和用户信息，生成基于时间戳、随机数和用户令牌的 SHA256 签名。

## 主要功能

### 1. 签名生成
- `signature(timestamp, key)`: 生成签名
  - 使用 AES 加密随机数
  - 结合时间戳、随机数和用户令牌生成签名数组
  - 对签名数组进行排序后生成 SHA256 签名

### 2. 辅助方法
- `nonce`: 随机字符串生成器
  - 使用 `util-str.js` 中的 `uuid` 方法生成 16 位随机字符串

## 实现原理

1. 生成随机字符串 nonce（16位）
2. 使用密钥对 nonce 进行 AES 加密
3. 构建签名数组，包含：
   - 加密后的 nonce
   - 时间戳
   - 原始 nonce
   - 用户令牌（从登录信息中获取）
4. 对签名数组进行排序
5. 将排序后的数组元素拼接成字符串
6. 对拼接后的字符串进行 SHA256 加密生成最终签名

## 使用示例

```javascript
// 生成签名
const sig = $signature.signature();
console.log(sig); // 输出 SHA256 签名

// 获取随机数
const nonce = $signature.nonce;
console.log(nonce); // 输出 16 位随机字符串
```

## 配置参数

### 默认配置
- `KEY`: '8bb3529e14d44cf7b740ce966e0df92b'（签名密钥）
- `IV`: ''（初始化向量，为空字符串）

### 依赖模块
- `crypto.js`: 加密功能支持
- `util-str.js`: 字符串工具支持
- `util-login.js`: 用户登录信息获取

## 注意事项
1. 签名生成依赖用户登录状态（需要获取用户令牌）
2. 使用 SHA256 算法确保签名安全性
3. 包含时间戳防止重放攻击
4. 使用随机数增加签名的唯一性
5. 密钥和初始化向量可自定义传入